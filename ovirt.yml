---
- name: oVirt Host
  remote_user: svc-ansible
  become: true
  hosts: ovirt

  tasks:

  # assert that OS <= 7

  - name: Install oVirt repos
    yum:
      name: https://resources.ovirt.org/pub/yum-repo/ovirt-release43.rpm
      state: present

  - name: Install oVirt cockpit dashboard
    yum:
      name: cockpit-ovirt-dashboard
      state: present

  - name: Enable cockpit firewall ports
    firewalld:
      service: cockpit
      immediate: yes
      permanent: yes
      state: enabled

  - name: Enable cockpit
    systemd:
      name: cockpit.socket
      state: started
