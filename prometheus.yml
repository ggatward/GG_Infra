---
- name: Install Prometheus
  remote_user: svc-ansible
  become: true
  hosts: docker_nas
  vars_files:
  - vault.yml

  tasks:
  - name: Deploy Prometheus container
    tags:
    - monitoring
    - prometheus
    - docker
    import_role:
      name: ansible-role-docker-prometheus
    vars:
      docker_persistent_store_root: /volume2/docker/prometheus
      docker_ext_prometheus_port: '9990'
      prometheus_config_global_external_labels:
        prom_cluster: CORE
      # prometheus_node_exporter_targets:
      # - project: HOME
      #   targets:
      #   - "openhab.core.home.gatwards.org:9100"
      #   - "rpi-util1.core.home.gatwards.org:9100"
      #   - "rpi-util2.core.home.gatwards.org:9100"
      #   - "foreman.core.home.gatwards.org:9100"
      #   - "kvm1.core.home.gatwards.org:9100"
      #   - "ipa1.ipa.home.gatwards.org:9100"
      #   - "ipa2.ipa.home.gatwards.org:9100"
